<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
    <style>
    .content{
        margin-left: 350px;
    }
    </style>
</head>
<body class="container-fluid">

	<header>
		<% include ../partials/headerLoggedIn %>
	</header>

	<main>
        
		<!-- <div class="row"> -->
        <% include ../partials/SideBar %>
			
        <div class = "content">
        <form method="POST" action="/profile/update">
            <label for="username"><b>Username</b></label>
            <input type="text" name="username" value="<%=data[0].username%>" disabled>
            <br>
            <label for="first_name"><b>First Name</b></label>
            <input type="text" name="first_name" value="<%=data[0].firstName%>" disabled>
            <br>
            <label for="last_name"><b>Last Name</b></label>
            <input type="text" name="last_name" value="<%=data[0].lastName%>" disabled>
            <br>
            <label for="email"><b>Email</b></label>
            <input type="email" name="email" value="<%=data[0].email%>" required>
            <br>
            <button type="submit">Update Email Address</button>
        </form>
                <br>
                <!-- Buttons -->
                <button type="button" data-toggle="modal" data-target="#pwreset">Reset Password</button>
                    <!-- Modal -->
                    <div id="pwreset" class="modal fade" role="dialog">
                            <div class="modal-dialog">
                            
                              <!-- Modal content-->
                              <div class="modal-content">
                                <div class="modal-header">
                                    <h1>Password Reset</h1>
                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                  
                                </div>
                                <form id="pwform">
                                    <div class="modal-body">
                                        <label for="password"><b>New Password:</b></label>
                                        <input class="pw" type="password" placeholder="Enter Password" name="password" required>
                                        <br>
                                        <label for="password_reenter"><b>Re-Enter New Password:</b></label>
                                        <input class="repw" type="password" placeholder="Enter Password" name="password_reenter" required>
                                        <br>
                                        <span>Password must be between 8-16 characters in length</span>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                      <button type="submit" class="btn btn-default pwnext">Next</button>
                                    </div>
                                </form>
                              </div>
                          
                            </div>
                          </div>
                <h6>Insert a short biography to tell other users who you are:</h6>
                <textarea id = "bio" name="biography" rows="5" cols="60" disabled><%=data[1]%></textarea>
                <!-- Buttons -->
                <hr>
                <button type="button" data-toggle="modal" data-target="#bioUpdate">Update Bio</button>
                    <!-- Modal -->
                    <div id="bioUpdate" class="modal fade" role="dialog">
                            <div class="modal-dialog">
                            
                              <!-- Modal content-->
                              <div class="modal-content">
                                <div class="modal-header">
                                    <h1>Bio Update</h1>
                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                  
                                </div>
                                <form id="bioform">
                                    <div class="modal-body">
                                        <textarea id = "bio" name="biography" rows="5" cols="60"></textarea>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                      <button type="submit" class="btn btn-default bionext">Next</button>
                                    </div>
                                </form>
                              </div>
                          
                            </div>
                          </div>
    
        
                <!-- div for profile image -->
                        <div class="profileImage">
                            <img src = "<%=data[2]%>">

                        </div>



        </div>
    <!-- </div> -->
        

	</main>

	<footer>
		<% include ../partials/footer %>
    </footer>
    
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"     integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"     crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <% include ../partials/script %>
    <script type="text/javascript">
    bioPopulate();
    $(".pwnext").on("click",function(event){
        event.preventDefault();
        var PW = $(".pw").val();
        var RePW = $(".repw").val();
        if(PW !== RePW)
        {
            alert("Passwords do not match");
            $(".pw").val("");
            $(".repw").val("");
        }
        else
        {
            var PWL = $(".pw").val().length;
            // alert(PWL);
            if(PWL < 8 || PWL > 16)
            {
                alert("Password must be between 8 to 16 characters long");
                $(".pw").val("");
                $(".repw").val("");
            }
            else
            {
                $("#pwform").attr("method","POST");
                $("#pwform").attr("action","/profile");
                $("#pwform").submit();
            }
            console.log(PWL);
        }
     
    })


    $(".bionext").on("click",function(event){
        event.preventDefault();
        $("#bioform").attr("method","POST");
        $("#bioform").attr("action","/bio");
        $("#bioform").submit();
    })

    function bioPopulate(){
        console.log($("textarea").val());
        if($("textarea").val() == "")
        {
            $("textarea").attr("placeholder","Put something here to introduce yourself to other users!");
        }     
    }
    // window.onload=bioPopulate;
</script>


</body>
</html>